<script>
    const socket = io("https://clean-the-net-.onrender.com");

    // 1. ÙˆØ¸ÙŠÙØ© Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ù„Ù„Ø³ØªØ§Ø±Ø© (OneSignal) ÙˆÙ„Ù„Ø¹Ø¯Ø§Ø¯ (Socket)
    async function sendLink() {
        const input = document.getElementById('linkInput');
        const link = input.value.trim();
        
        if(link) {
            // Ø£ÙˆÙ„Ø§Ù‹: Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø§Ø¨Ø· Ù„Ù„Ø¹Ø¯Ø§Ø¯ ÙˆØ§Ù„Ù„ÙˆÙ† (Socket.io)
            socket.emit('sendTargetLink', link); 

            // Ø«Ø§Ù†ÙŠØ§Ù‹: Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Ø­Ù‚ÙŠÙ‚ÙŠ Ù„Ø³ØªØ§Ø±Ø© Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ (OneSignal)
            // Ù…Ù„Ø§Ø­Ø¸Ø©: Ø¯ÙŠ Ø¨ØªØ¨Ø¹Øª Ù„ÙƒÙ„ Ø§Ù„Ù†Ø§Ø³ Ø§Ù„Ù„ÙŠ Ø¯Ø§Ø³ÙˆØ§ "Allow"
            OneSignalDeferred.push(async function(OneSignal) {
                await OneSignal.Notifications.requestPermission();
                // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ†
                // Ù…Ù„Ø§Ø­Ø¸Ø©: ÙŠÙØ¶Ù„ Ø¥Ø±Ø³Ø§Ù„Ù‡Ø§ Ù…Ù† Ø§Ù„Ù€ Dashboard Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø£Ù…Ø§Ù† ÙÙŠ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ©
                console.log("ØªÙ… Ø¥Ø·Ù„Ø§Ù‚ Ù†Ø¯Ø§Ø¡ Ø³Ø§Ø¹Ø© Ø§Ù„ØµÙØ± Ù„Ù„Ø³ØªØ§Ø±Ø©!");
            });

            input.value = '';
            alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø´Ø§Ø±Ø© Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¨Ø·Ø§Ù„! ðŸ«¡");
        } else {
            alert("ÙŠØ§ Ø¨Ø·Ù„ØŒ Ø­Ø· Ø±Ø§Ø¨Ø· Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ø£ÙˆÙ„!");
        }
    }

    // 2. Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„Ù„Ø­Ø¸ÙŠ (ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©)
    socket.on('zeroHourAlert', (data) => {
        document.getElementById('alertBox').style.display = 'block';
        document.getElementById('targetBtn').href = data.target;
        document.body.style.backgroundColor = "#ffcccc";
        if(navigator.vibrate) navigator.vibrate([300, 100, 300, 100, 500]);
    });

    socket.on('updateUserCount', (count) => {
        document.getElementById('userCount').innerText = count;
    });
</script>
